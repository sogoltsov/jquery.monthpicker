/*! jQuery-ui Monthpicker - v0.1.0 - 2012-06-09
* https://github.com/sogoltsov/jquery.monthpicker
* Copyright (c) 2012 Sergey Ogoltsov; Licensed MIT, GPL */
(function(a){a.widget("ui.monthpicker",{options:{clear:null,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],disabled:!1,defaultYear:null,defaultMonth:null,showMonthAfterYear:!0,useShortMonthNames:!1,yearSuffix:"",_inDialog:!1,duration:1,zIndex:null},_create:function(){var b=this,c=b.options;this.ym=this._getDefaultYM(),this.mpDiv=b.element,b.element.addClass(" ui-monthpicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all ").append(this._generateHTML()),this._bindHover(),b.ymButton=this.mpDiv.find(".ui-monthpicker-month-year-cell"),b.prevYearButton=b.element.find(".ui-monthpicker-prev-year"),b.prevMonthButton=b.element.find(".ui-monthpicker-prev-month"),b.nextMonthButton=b.element.find(".ui-monthpicker-next-month"),b.nextYearButton=b.element.find(".ui-monthpicker-next-year"),b.prevYearButton.bind("click.monthpicker",function(a){c.disabled?(a.preventDefault(),a.stopImmediatePropagation()):b._adjustYM(-100)}),b.prevMonthButton.bind("click.monthpicker",function(a){c.disabled?(a.preventDefault(),a.stopImmediatePropagation()):b._adjustYM(-1)}),b.nextMonthButton.bind("click.monthpicker",function(a){c.disabled?(a.preventDefault(),a.stopImmediatePropagation()):b._adjustYM(1)}),b.nextYearButton.bind("click.monthpicker",function(a){c.disabled?(a.preventDefault(),a.stopImmediatePropagation()):b._adjustYM(100)}),b.mainPickerDiv=a('<div class="ui-monthpicker-popup ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>').append(this._generateMonthpickerHTML()),isNaN(b.options.zIndex)||b.mpDiv.css("z-index",b.options.zIndex),isNaN(b.mpDiv.css("z-index"))||b.mainPickerDiv.css("z-index",b.mpDiv.css("z-index")+1),this._bindHoverPopup(),b.mainPickerDiv.css("display","none"),b.mainPickerDiv.find(".ui-monthpicker-picker-ok-btn").bind("click.monthpicker",function(){b.ym=b.drawYear*100+b.drawMonth,b.ymButton.empty().append(b._generateMonthYearHeader()),b.mainPickerDiv.hide(),b._trigger("change",null,b.ym)}),b.mainPickerDiv.find(".ui-monthpicker-picker-cancel-btn").bind("click.monthpicker",function(){b.mainPickerDiv.hide()}),b.mainPickerDiv.find(".ui-monthpicker-picker-prev-year-cell").bind("click.monthpicker",function(){b.baseYear-=10,b._selectYear(b.drawYear)}),b.mainPickerDiv.find(".ui-monthpicker-picker-next-year-cell").bind("click.monthpicker",function(){b.baseYear+=10,b._selectYear(b.drawYear)}),b.mainPickerDiv.find(".ui-monthpicker-picker-year-cell button").bind("click.monthpicker",function(a){var c=parseInt(a.srcElement.innerText,10);isNaN(c)||(b.drawYear=c,b._selectYear(b.drawYear))}),b.mainPickerDiv.find(".ui-monthpicker-picker-month-cell button").bind("click.monthpicker",function(c){var d=a(c.srcElement),e=null;for(var f=0;f<12;f++)if(d.hasClass("ui-monthpicker-picker-month-"+f)){e=f;break}isNaN(e)||(b.drawMonth=e,b._selectMonth(b.drawMonth))}),a("body").append(b.mainPickerDiv),b.ymButton.bind("click.monthpicker",function(a){b._showMonthYearPicker()})},_showMonthYearPicker:function(){var b=this;b.drawYear=b.baseYear=b._ym2year(b.ym),b.drawMonth=b._ym2month(b.ym),b._selectYear(b.drawYear),b._selectMonth(b.drawMonth);if(!b._pos){var c=b.mpDiv.offset();b._pos=[c.left,c.top]}var d=!1;b.mpDiv.parents().each(function(){return d|=a(this).css("position")==="fixed",!d}),d&&a.browser.opera&&(b._pos[0]-=document.documentElement.scrollLeft,b._pos[1]-=document.documentElement.scrollTop);var e={left:b._pos[0],top:b._pos[1]};b._pos=null,b.mainPickerDiv.css({position:"absolute",display:"block",top:"-1000px"}),e=this._checkOffset(e,d);var f=b._inDialog&&a.blockUI?"static":d?"fixed":"absolute",g=b.mpDiv.innerWidth();b.mainPickerDiv.css({position:f,display:"none",left:e.left+"px",top:e.top+"px",width:g+"px"});var h=b.mpDiv.css("zIndex")+1;b.mainPickerDiv.css("zIndex",h);var i=function(){var a=b.mainPickerDiv.find("iframe.ui-monthpicker-cover");if(!!a.length){var c=this._getBorders(b.mainPickerDiv);a.css({left:-c[0],top:-c[1],width:b.mainPickerDiv.outerWidth(),height:b.mainPickerDiv.outerHeight()})}};b.mainPickerDiv.show(!0,null,b.options.duration,i)},_checkOffset:function(b,c){var d=this,e=this.mainPickerDiv.outerWidth(),f=this.mainPickerDiv.outerHeight(),g=this.mpDiv?this.mpDiv.outerWidth():0,h=this.mpDiv?this.mpDiv.outerHeight():0,i=document.documentElement.clientWidth+a(document).scrollLeft(),j=document.documentElement.clientHeight+a(document).scrollTop();return b.left-=this.options.isRTL?e-g:0,b.left-=c&&b.left===d.input.offset().left?a(document).scrollLeft():0,b.top-=c&&b.top===d.input.offset().top+h?a(document).scrollTop():0,b.left-=Math.min(b.left,b.left+e>i&&i>e?Math.abs(b.left+e-i):0),b.top-=Math.min(b.top,b.top+f>j&&j>f?Math.abs(f+h):0),b},_calcYM:function(a,b){b=Math.floor(b);var c=b%100;if(c!==0){var d=this._ym2year(a)*100+(b<0?Math.ceil(b/12):Math.floor(b/12))*100,e=this._ym2month(a),f=(e+c)%12;f<0?(d-=100,e=f+12):e+c>11?(d+=100,e=f):e=f,a=d+(d>-1?e:-1*e)}else a+=b;return a},_adjustYM:function(a){this.ym=this._calcYM(this.ym,a),this.ymButton.empty().append(this._generateMonthYearHeader()),this._trigger("change",null,this.ym)},_getDefaultYM:function(){var a=this.options.defaultYear,b=this.options.defaultMonth;if(a==null||b==null){var c=new Date;a==null&&(a=c.getFullYear()),b==null&&(b=c.getMonth())}return Math.floor(a*100+b)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments)},destroy:function(){a.Widget.prototype.destroy.call(this)},_getBorders:function(a){var b=function(a){return{thin:1,medium:2,thick:3}[a]||a};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_ym2year:function(a){return a>=0?Math.floor(a/100):Math.ceil(a/100)},_ym2month:function(a){return Math.abs(a%100)},_selectMonth:function(b){var c=".ui-monthpicker-picker-month-cell button",d=a(this.mainPickerDiv).find(c);d.removeClass("ui-state-default"),d=a(this.mainPickerDiv).find(".ui-monthpicker-picker-month-"+b),d.addClass("ui-state-default")},_selectYear:function(b){var c=".ui-monthpicker-picker-year-cell button",d=a(this.mainPickerDiv).find(c);for(var e=0;e<5;e++)a(d[e*2]).text(this.baseYear-4+e),a(d[e*2+1]).text(this.baseYear+1+e);d.removeClass("ui-state-default");if(this.drawYear-5<b&&this.baseYear+6>b){var f=b-this.baseYear+4;d=a(this.mainPickerDiv).find(".ui-monthpicker-picker-year-"+f),d.addClass("ui-state-default")}},_generateMonthYearHeader:function(){var a=this._ym2month(this.ym),b=this._ym2year(this.ym),c=this.options.useShortMonthNames?this.options.monthNamesShort:this.options.monthNames,d='<div class="ui-monthpicker-title">',e="";return e+='<span class="ui-monthpicker-month">'+c[a]+"</span>",this.options.showMonthAfterYear||(d+=e+"&#xa0;"),d+='<span class="ui-monthpicker-year">'+b+"</span>",d+=this.options.yearSuffix,this.options.showMonthAfterYear&&(d+="&#xa0;"+e),d+="</div>",d},_generateHTML:function(){var a='<table border="0" cellpadding="0" cellspacing="0" class="ui-monthpicker-group ui-monthpicker-header ui-widget-header ui-helper-clearfix ui-corner-all"><tbody><tr><td class="ui-monthpicker-prev-year ui-corner-all"><<</td><td class="ui-monthpicker-prev-month ui-corner-all"><</td><td class="ui-monthpicker-month-year-cell ui-corner-all">'+this._generateMonthYearHeader()+"</td>"+'<td class="ui-monthpicker-next-month ui-corner-all">></td>'+'<td class="ui-monthpicker-next-year ui-corner-all">>></td>'+"</tr></tbody></table>";return a},_generateMonthpickerHTML:function(){var a=this.options.monthNamesShort,b='<table border="0" cellpadding="0" cellspacing="0" class="ui-monthpicker-picker ui-helper-clearfix ui-corner-all"><tbody><tr><td class="ui-monthpicker-picker-month-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-month-0">'+a[0]+"</button></td>"+'   <td class="ui-monthpicker-picker-month-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-month-6">'+a[6]+"</button></td>"+'   <td class=""><button class="ui-monthpicker-picker-prev-year-cell ui-button ui-button-text-only ui-corner-all"><</button></td>'+'   <td class=""><button class="ui-monthpicker-picker-next-year-cell ui-button ui-button-text-only ui-corner-all">></button></td></tr>'+'<tr><td class="ui-monthpicker-picker-month-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-month-1">'+a[1]+'</button></td><td class="ui-monthpicker-picker-month-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-month-7">'+a[7]+"</button></td>"+'   <td class="ui-monthpicker-picker-year-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-year-0"></button></td><td class="ui-monthpicker-picker-year-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-year-5"></button></td></tr>'+'<tr><td class="ui-monthpicker-picker-month-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-month-2">'+a[2]+'</button></td><td class="ui-monthpicker-picker-month-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-month-8">'+a[8]+"</button></td>"+'   <td class="ui-monthpicker-picker-year-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-year-1"></button></td><td class="ui-monthpicker-picker-year-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-year-6"></button></td></tr>'+'<tr><td class="ui-monthpicker-picker-month-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-month-3">'+a[3]+'</button></td><td class="ui-monthpicker-picker-month-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-month-9">'+a[9]+"</button></td>"+'   <td class="ui-monthpicker-picker-year-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-year-2"></button></td><td class="ui-monthpicker-picker-year-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-year-7"></button></td></tr>'+'<tr><td class="ui-monthpicker-picker-month-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-month-4">'+a[4]+'</button></td><td class="ui-monthpicker-picker-month-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-month-10">'+a[10]+"</button></td>"+'   <td class="ui-monthpicker-picker-year-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-year-3"></button></td><td class="ui-monthpicker-picker-year-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-year-8"></button></td></tr>'+'<tr><td class="ui-monthpicker-picker-month-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-month-5">'+a[5]+'</button></td><td class="ui-monthpicker-picker-month-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-month-11">'+a[11]+"</button></td>"+'   <td class="ui-monthpicker-picker-year-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-year-4"></button></td><td class="ui-monthpicker-picker-year-cell"><button class="ui-button ui-button-text-only ui-corner-all ui-monthpicker-picker-year-9"></button></td></tr>'+'<tr class="ui-widget-header">'+'<td colspan="2" class="ui-monthpicker-picker-ok-cell"><button class="ui-monthpicker-picker-ok-btn ui-widget ui-button ui-button-text-only ui-state-default ui-corner-all">OK</button></td>'+'<td colspan="2" class="ui-monthpicker-picker-cancel-cell"><button class="ui-monthpicker-picker-cancel-btn ui-widget ui-button ui-button-text-only ui-state-default ui-corner-all">Cancel</button></td>'+"</tr>"+"</tbody></table>";return b},_bindHover:function(){var b=this,c="button, .ui-monthpicker-prev-year, .ui-monthpicker-prev-month, .ui-monthpicker-next-month, .ui-monthpicker-next-year, .ui-monthpicker-month-year-cell, .ui-monthpicker-calendar td a";return b.mpDiv.bind("mouseout.monthpicker",function(b){var d=a(b.target).closest(c);if(!d.length)return;d.removeClass("ui-state-hover ui-monthpicker-prev-year-hover ui-monthpicker-prev-month-hover ui-monthpicker-next-month-hover ui-monthpicker-next-year-hover")}).bind("mouseover.monthpicker",function(d){var e=a(d.target).closest(c);if(b.options.disabled||!e.length)return;e.parents(".ui-monthpicker-calendar").find("a").removeClass("ui-state-hover"),e.addClass("ui-state-hover"),e.hasClass("ui-monthpicker-prev-year")&&e.addClass("ui-monthpicker-prev-year-hover"),e.hasClass("ui-monthpicker-month-year")&&e.addClass("ui-monthpicker-prev-month-hover"),e.hasClass("ui-monthpicker-next-month")&&e.addClass("ui-monthpicker-next-month-hover"),e.hasClass("ui-monthpicker-next-year")&&e.addClass("ui-monthpicker-next-year-hover")})},_bindHoverPopup:function(){var b=this,c="button, .ui-monthpicker-picker-month-cell button, .ui-monthpicker-picker-year-cell button, .ui-monthpicker-picker-prev-year-cell, .ui-monthpicker-picker-next-year-cell";return b.mainPickerDiv.bind("mouseout.monthpicker",function(b){var d=a(b.target).closest(c);if(!d.length)return;d.removeClass("ui-state-hover ui-monthpicker-picker-month-cell-hover ui-monthpicker-picker-year-cell-hover ui-monthpicker-picker-prev-year-cell-hover ui-monthpicker-picker-next-year-cell-hover")}).bind("mouseover.monthpicker",function(d){var e=a(d.target).closest(c);if(b.options.disabled||!e.length)return;e.parents(".ui-monthpicker-picker").find("a").removeClass("ui-state-hover"),e.addClass("ui-state-hover"),e.hasClass("ui-monthpicker-picker-month-cell")&&e.addClass("ui-monthpicker-picker-month-cell-hover"),e.hasClass("ui-monthpicker-picker-year-cell")&&e.addClass("ui-monthpicker-picker-year-cell-hover"),e.hasClass("ui-monthpicker-picker-prev-year-cell")&&e.addClass("ui-monthpicker-picker-prev-year-cell-hover"),e.hasClass("ui-monthpicker-picker-next-year-cell")&&e.addClass("ui-monthpicker-picker-next-year-cell-hover")})},year:function(a){if(!(arguments.length>0))return this._ym2year(this.ym);a=Math.ceil(a);var b=this._ym2month(this.ym);this.ym=a*100+b*(a<0?-1:1),this.ymButton.empty().append(this._generateMonthYearHeader()),this.mainPickerDiv.is(":visible")&&(this.baseYear=this._ym2year(this.ym),this._selectYear(this.baseYear)),this._trigger("change",null,this.ym)},month:function(a){if(!(arguments.length>0))return this._ym2month(this.ym);a=Math.ceil(a);if(a<0||a>11)return;var b=this._ym2year(this.ym);this.ym=b*100+a*(b<0?-1:1),this.ymButton.empty().append(this._generateMonthYearHeader()),this.mainPickerDiv.is(":visible")&&this._selectMonth(this._ym2month(this.ym)),this._trigger("change",null,this.ym)},yearMonth:function(a){if(!(arguments.length>0))return this.ym;a=Math.ceil(a);var b=this._ym2month(a);if(b<0||b>11)return;this.ym=a,this.ymButton.empty().append(this._generateMonthYearHeader()),this.mainPickerDiv.is(":visible")&&(this.baseYear=this._ym2year(this.ym),this._selectYear(this.baseYear),this._selectMonth(this._ym2month(this.ym))),this._trigger("change",null,this.ym)}})})(jQuery);